from openai import OpenAI
from AI_Models import Google_Custom_Search_Engine , openrouter_modle
from Ai_API_Key import Custom_Search_API , openrouter_API
from raq_system import raq_system

def CreateArticleText(title , word , raq_data):
    client = OpenAI(
    base_url="https://openrouter.ai/api/v1",
    api_key= openrouter_API,
    )

    completion = client.chat.completions.create(
    model= openrouter_modle,
    messages=[
        {
        "role": "system",
        "content": [
            {
            "type": "text",
            "text": """یک مقاله جامع، خوانا و حرفه‌ای تولید کن که از نظر سئو بهینه باشد و هدفمند نوشته شود تا نیاز کاربر را به بهترین شکل برآورده کند.

شرایط و ویژگی‌های مقاله:

حفظ عنوان مقاله: عنوان (تایتل) مقاله نباید تغییر کند، اما برای بهبود سئوی مقاله، می‌توان کلمات کلیدی را تغییر داد یا به آن اضافه کرد.

استفاده از منابع داده‌شده: اگر اطلاعات مورد نیاز در داده‌های اولیه موجود باشد، باید از آنها استفاده شود. در صورتی که این اطلاعات ناقص یا قدیمی باشند، می‌توان از مقالات داده‌شده برای تکمیل، به‌روزرسانی و استخراج داده‌های معتبر استفاده کرد.

انعطاف‌پذیری در ترکیب اطلاعات: اطلاعات را می‌توان بازنویسی، ترکیب و ساختاربندی کرد تا مقاله‌ای منسجم، دقیق و کاربردی حاصل شود.

کنترل بر اطلاعات جدید: اگر مقاله دارای ماهیت خبری است و نیاز به اطلاعات دقیق و جدید دارد، بهتر است فقط از مقالات داده‌شده استفاده شود و به اطلاعات قدیمی توجه ویژه‌ای شود تا مقاله از نظر زمانی دچار اشتباه نشود.

ساختار استاندارد و خوانایی بالا: مقاله باید به‌صورت حرفه‌ای و خوانا نگارش شود و دارای تیترهای مناسب و ساختاربندی استاندارد باشد.

مقایسه و جدول‌بندی: در صورت نیاز، می‌توان از جداول برای مقایسه، خلاصه‌سازی یا نمایش بهتر اطلاعات استفاده کرد.

افزودن تصاویر مناسب:

تصاویر باید درون دو آکولاد قرار بگیرند، به این صورت:

{{متن مناسب برای جستجو در گوگل جهت دریافت تصویر}}

(این متن باید عبارتی باشد که تصویر مناسب را هنگام جستجو در گوگل نمایش دهد.)

اولویت در جستجوی تصاویر با زبان انگلیسی است؛ اگر احساس کردی در منابع انگلیسی تصویر موردنظر پیدا نمی‌شود، می‌توانی در منابع فارسی جستجو کنی. برای مثال، نام اشخاص، محصولات ایرانی یا مفاهیم خاص مرتبط با ایران را می‌توان در جستجو گنجاند.

تعداد تصاویر نباید بیش از حد زیاد باشد؛ تقریباً ۴ تصویر به ازای هر ۱۰۰۰ کلمه کافی است.

مهم: در خروجی هیچ سخن اضافه‌ای نباید قرار داده شود و تنها متن مقاله بدون هیچ توضیح دیگری تولید شود تا از بروز اختلال جلوگیری شود. اگر محتوای مقاله خبری بود، باید از ساختار محتوایی استاندارد خبرنویسی پیروی کند.

هدف نهایی: تولید مقاله‌ای که از نظر محتوا، به‌روز بودن، انسجام و خوانایی در سطحی حرفه‌ای باشد و اطلاعات ارائه‌شده را به شکلی بهینه و هدفمند در اختیار کاربر قرار دهد.

"""
            }
        ]
        },
        {
        "role": "user",
        "content": [
            {
            "type": "text",
            "text": f""""
            عنوان : {title}
            کلمات کلیدی : {word}
            اطلاعات استخراج شده از دگرسایت ها : 
            {raq_data}"""
            }
        ]
        }
    ]
    )
    return completion.choices[0].message.content


title = "10 هوش مصنوعی ساخت عکس رایگان"
word = "هوش مصنوعی و رایگان"
raq_data = raq_system(title , word)
print("Producing the main text of the article ....")
print(CreateArticleText(title , word , raq_data))